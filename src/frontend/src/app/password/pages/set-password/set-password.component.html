<ngx-loading-bar [color]="'#4a358c'" [includeSpinner]="false" [height]="'3px'"></ngx-loading-bar>
<app-title [title]="'title.set_password' | translate"></app-title>
<div class="d-lg-flex half">
  <div class="bg-reset order-md-2"></div>
  <div class="reset-wrapper order-md-1">
    <div class="container">
      <div class="row align-items-center justify-content-center">
        <div class="col-md-7">
          <div class="reset-form" style="opacity: 1">
            <!-- LOADING -->
            <div *ngIf="mode === 'LOADING'" class="mt-5 mb-4">
              <div class="spinner">
                <div class="spinner-box">
                  <mat-spinner [diameter]="30"></mat-spinner>
                </div>
              </div>
            </div>

            <!-- INVALID -->
            <div *ngIf="mode === 'INVALID'">
              <p class="text-center pt-2" [innerHTML]="'password.msg.invalid_body' | translate"></p>
            </div>

            <!-- FINISHED -->
            <div *ngIf="mode === 'FINISHED'">
              <h3 class="text-center">
                {{ 'password.msg.success_title' | translate }}
              </h3>
              <p class="pb-3 text-center">
                {{ 'password.msg.success_body' | translate }}
              </p>
              <div class="my-3 d-flex justify-content-center">
                <button mat-raised-button color="primary" [routerLink]="'/login'">
                  {{ 'common.login' | translate }}
                </button>
              </div>
            </div>

            <!-- READY -->
            <div *ngIf="mode === 'READY'">
              <p>
                <img [src]="'assets/img/logbook-logo.svg'" alt="image" style="width: 45%" />
              </p>
              <span class="app-title">{{ subtitle }}</span>
              <div class="reset-form-input">
                <form [formGroup]="formGroup" (ngSubmit)="onSubmit()">
                  <p>{{ 'password.intro' | translate }}</p>
                  <div class="input-form">
                    <app-form-input
                      [type]="'email'"
                      [label]="'common.email'"
                      [control]="asFormControl(formGroup.controls['email'])"
                    ></app-form-input>
                    <app-form-password
                      [label]="'common.password'"
                      [control]="asFormControl(formGroup.controls['password'])"
                      [hint]="'users.hint.password'"
                      [errorTranslations]="errorTranslations.password"
                    ></app-form-password>
                    <app-form-password
                      [label]="'common.confirm_password'"
                      [control]="asFormControl(formGroup.controls['confirmPassword'])"
                      [errorTranslations]="errorTranslations.confirmPassword"
                    ></app-form-password>
                  </div>

                  <button mat-raised-button color="primary" type="submit" [disabled]="!formGroup.valid">
                    {{ 'common.submit' | translate }}
                  </button>
                </form>
                <div class="my-4">
                  <app-language-selector
                    [mode]="'list'"
                    [useIcon]="false"
                    [defaultLanguage]="defaultLanguage"
                    [languages]="languages"
                  ></app-language-selector>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
