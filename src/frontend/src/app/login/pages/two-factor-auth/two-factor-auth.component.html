<ngx-loading-bar [color]="'#4a358c'" [includeSpinner]="false" [height]="'3px'"></ngx-loading-bar>
<app-title [title]="'title.two_factor_authentication' | translate"></app-title>
<div class="two-factor-container">
  <div class="form">
    <div class="mb-3">
      <img src="assets/img/security.png" alt="security" style="width: 20%" />
    </div>
    <h1 class="title_card">{{ 'auth.authenticate_your_account' | translate }}</h1>
    <p>{{ 'auth.please_confirm' | translate }} {{ email }}</p>

    <form [formGroup]="formGroup">
      <div class="row d-flex justify-content-center mb-0">
        <p class="form-input">
          <mat-form-field appearance="standard">
            <input
              id="form1"
              type="text"
              formControlName="form1"
              maxlength="1"
              (keyup)="onDigitInput($event, 1)"
              (paste)="paste($event)"
              matInput
              autofocus
            />
          </mat-form-field>
        </p>
        <p class="form-input">
          <mat-form-field appearance="standard">
            <input
              id="form2"
              type="text"
              formControlName="form2"
              maxlength="1"
              (keyup)="onDigitInput($event, 2)"
              matInput
            />
          </mat-form-field>
        </p>
        <p class="form-input">
          <mat-form-field appearance="standard">
            <input
              id="form3"
              type="text"
              formControlName="form3"
              maxlength="1"
              (keyup)="onDigitInput($event, 3)"
              matInput
            />
          </mat-form-field>
        </p>
        <p class="form-input">
          <mat-form-field appearance="standard">
            <input
              id="form4"
              type="text"
              formControlName="form4"
              maxlength="1"
              (keyup)="onDigitInput($event, 4)"
              matInput
            />
          </mat-form-field>
        </p>
        <p class="form-input">
          <mat-form-field appearance="standard">
            <input
              id="form5"
              type="text"
              formControlName="form5"
              maxlength="1"
              (keyup)="onDigitInput($event, 5)"
              matInput
            />
          </mat-form-field>
        </p>
        <p class="form-input">
          <mat-form-field appearance="standard">
            <input
              id="form6"
              type="text"
              formControlName="form6"
              maxlength="1"
              (keyup)="onDigitInput($event, 6)"
              matInput
            />
          </mat-form-field>
        </p>
      </div>
    </form>

    <div class="d-flex justify-content-center">
      <button mat-raised-button color="primary" (click)="submit()" [disabled]="formGroup.invalid">
        {{ 'common.submit' | translate }}
      </button>

      <ng-container *ngIf="authService.currentTwoFactor?.mfaMethod == 'email'">
        <a [ngClass]="{ 'button-timer': resendButton === true }" class="mx-2 text-decoration-none" mat-button>
          <span id="time" class="timer-color">{{ timer }}</span>
        </a>
        <ng-container *ngIf="resendButton === true">
          <a class="mx-2 text-decoration-none" mat-button (click)="resendToken()">
            {{ 'common.resend' | translate }}
          </a>
        </ng-container>
      </ng-container>
    </div>
  </div>
</div>
